"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .servicegroupaccountandservicelevel import (
    ServiceGroupAccountAndServiceLevel,
    ServiceGroupAccountAndServiceLevelTypedDict,
)
from .servicegrouptypeenum import ServiceGroupTypeEnum
from pydantic import model_serializer
from shippo.types import BaseModel, UNSET_SENTINEL
from typing import List, Optional
from typing_extensions import NotRequired, TypedDict


class ServiceGroupTypedDict(TypedDict):
    description: str
    r"""Description for the service group"""
    name: str
    r"""Name for the service group that will be shown to customers in the response"""
    type: ServiceGroupTypeEnum
    r"""The type of the service group.<br>
    `LIVE_RATE` - Shippo will make a rating request and return real-time rates for the shipping group, only falling back to the specified flat rate amount if no rates match a service level in the service group.<br>
    `FLAT_RATE` - Returns a shipping option with the specified flat rate amount.<br>
    `FREE_SHIPPING` - Returns a shipping option with a price of $0 only if the total cost of items exceeds the amount defined by `free_shipping_threshold_min`
    """
    object_id: str
    r"""The unique identifier of the given Service Group object."""
    service_levels: List[ServiceGroupAccountAndServiceLevelTypedDict]
    flat_rate: NotRequired[str]
    r"""String representation of an amount to be returned as the flat rate
    if 1. The service group is of type `LIVE_RATE` and no matching rates
    were found; or 2. The service group is of type `FLAT_RATE`. Either
    integers or decimals are accepted. Required unless type is
    `FREE_SHIPPING`
    """
    flat_rate_currency: NotRequired[str]
    r"""required unless type is `FREE_SHIPPING`. (ISO 4217 currency)"""
    free_shipping_threshold_currency: NotRequired[str]
    r"""optional unless type is `FREE_SHIPPING`. (ISO 4217 currency)"""
    free_shipping_threshold_min: NotRequired[str]
    r"""For service groups of type `FREE_SHIPPING`, this field must be required to configure the minimum
    cart total (total cost of items in the cart) for this service group to be returned for rates at
    checkout. Optional unless type is `FREE_SHIPPING`
    """
    rate_adjustment: NotRequired[int]
    r"""The amount in percent (%) that the service group's returned rate should be adjusted. For example, if this field is set to 5 and the matched rate price is $5.00, the returned value of the service group will be $5.25. Negative integers are also accepted and will discount the rate price by the defined percentage amount."""
    is_active: NotRequired[bool]
    r"""True if the service group is enabled, false otherwise."""


class ServiceGroup(BaseModel):
    description: str
    r"""Description for the service group"""

    name: str
    r"""Name for the service group that will be shown to customers in the response"""

    type: ServiceGroupTypeEnum
    r"""The type of the service group.<br>
    `LIVE_RATE` - Shippo will make a rating request and return real-time rates for the shipping group, only falling back to the specified flat rate amount if no rates match a service level in the service group.<br>
    `FLAT_RATE` - Returns a shipping option with the specified flat rate amount.<br>
    `FREE_SHIPPING` - Returns a shipping option with a price of $0 only if the total cost of items exceeds the amount defined by `free_shipping_threshold_min`
    """

    object_id: str
    r"""The unique identifier of the given Service Group object."""

    service_levels: List[ServiceGroupAccountAndServiceLevel]

    flat_rate: Optional[str] = None
    r"""String representation of an amount to be returned as the flat rate
    if 1. The service group is of type `LIVE_RATE` and no matching rates
    were found; or 2. The service group is of type `FLAT_RATE`. Either
    integers or decimals are accepted. Required unless type is
    `FREE_SHIPPING`
    """

    flat_rate_currency: Optional[str] = None
    r"""required unless type is `FREE_SHIPPING`. (ISO 4217 currency)"""

    free_shipping_threshold_currency: Optional[str] = None
    r"""optional unless type is `FREE_SHIPPING`. (ISO 4217 currency)"""

    free_shipping_threshold_min: Optional[str] = None
    r"""For service groups of type `FREE_SHIPPING`, this field must be required to configure the minimum
    cart total (total cost of items in the cart) for this service group to be returned for rates at
    checkout. Optional unless type is `FREE_SHIPPING`
    """

    rate_adjustment: Optional[int] = None
    r"""The amount in percent (%) that the service group's returned rate should be adjusted. For example, if this field is set to 5 and the matched rate price is $5.00, the returned value of the service group will be $5.25. Negative integers are also accepted and will discount the rate price by the defined percentage amount."""

    is_active: Optional[bool] = None
    r"""True if the service group is enabled, false otherwise."""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "flat_rate",
                "flat_rate_currency",
                "free_shipping_threshold_currency",
                "free_shipping_threshold_min",
                "rate_adjustment",
                "is_active",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
